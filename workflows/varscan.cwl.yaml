class: Workflow
id: varscan_workflow

inputs:
  - id: "tumor"
    type: File
    secondaryFiles:
      - .bai

  - id: "normal"
    type: File
    secondaryFiles:
      - .bai

  - id: "reference"
    type: File
    secondaryFiles:
      - .fai

steps:
    - id: normal_pileup
      run:
        import: ../tools/samtools-pileup-tool/sam_pileup.cwl.yaml
      inputs:
        - id: "input"
          source: "#normal"
        - id: "reference"
          source: "#reference"

      outputs:
        - id: "output"

    - id: tumor_pileup
      run:
        import: ../tools/samtools-pileup-tool/sam_pileup.cwl.yaml
      inputs:
        - id: "input"
          source: "#tumor"
        - id: "reference"
          source: "#reference"

      outputs:
        - id: "output"
        
    - id: varscan
      run: 
        import: ../tools/varscan-tool/varscan_somatic.cwl.yaml
      inputs:
        - id: normal_pileup
          source: "#normal_pileup/output"
        - id: tumor_pileup
          source: "#tumor_pileup/output"

      outputs:
        - id: snp_vcf
        - id: indel_vcf

outputs:
    - id: varscan_snp_vcf
      type: File
      source: "#varscan/snp_vcf"
